
c---------------------------------------------------------------------
c---------------------------------------------------------------------
       pure extrinsic (hpf) 
     >        subroutine l2norm ( ldx, ldy, ldz, 
     >                    nx0, ny0, nz0,
     >                    ist, iend, 
     >                    jst, jend,
     >                    v, summ )
      implicit none
      include 'l2norm.h'
c---------------------------------------------------------------------
c---------------------------------------------------------------------

c---------------------------------------------------------------------
c   to compute the l2-norm of vector v.
c---------------------------------------------------------------------



c---------------------------------------------------------------------
c  local variables
c---------------------------------------------------------------------
      integer i, j, k, m

      do m = 1, 5
        summ(m) = sum(v(m,ist:iend,jst:jend,2:nz0-1)**2)
        summ(m) = sqrt ( summ(m) / ( (nx0-2)*(ny0-2)*(nz0-2) ) )
      end do

      return
      end
